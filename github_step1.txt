library(data.table)library(dplyr)library(tidyverse)library(ggplot2)library(GenomciRanges)library(biomartr)library(motifbreakR)library(cowplot)library(readr)#----------------------------------------------------##STEP 1##Read in hg38 SNP id positions, merge with alleles##Those are files from bcf to get chrom-pos#----------------------------------------------------##Tables#----------------------------------------------------#Ajore et al.#Castaldi et al.#Joslin et al.#Klein et al.#Myin et al.#Selvarajan et al.#Soemedi et al.#Zhang et al.#-----------------------------------------------------##Read in the bcf input files#-----------------------------------------------------file_list <- list.files(path = "/Users/rita/Desktop/MPRA_meta/Tested variants tables/input_bcf_rsID",                        pattern = "\\.tsv$", full.names = TRUE)for (file in file_list) {  table_name <- gsub("\\.tsv$", "", basename(file))  table_name <- gsub("\\.", "_", table_name)    df <- read.delim(file, header = FALSE)  names(df)[1:3] <- c("rsid", "ref", "alt")  assign(table_name, df) }#------------------------------##Read in the bcfoutput files#------------------------------file_list2 <- list.files(path = "/Users/rita/Desktop/MPRA_meta/Tested variants tables/bcfout_hg38",                          pattern = "\\.tsv$", full.names = TRUE)for (file in file_list2) {  table_name <- gsub("\\.tsv$", "", basename(file))  df <- read_delim(file, delim = "\t", col_names = FALSE)  df$X1 <- gsub("^chr", "", df$X1)  colnames(df) <- c("chrom", "pos", "rsid")  assign(table_name, df)}#----------------------##STEP 2##Merge files by rsid#---------------------#---------------------##Ajore##Input = 820##Output bcf = 816##non-annotated n=4#--------------------ajore_variants = merge(ajore_hg38_out, ajore_input, by = "rsid")ajore_variants$Author = "Ajore"ajore_variants <-ajore_variants %>% arrange(chrom)#-------------------------##Joslin##Input = 2396## output bcftools = 2394##non-annotated n=42#-------------------------joslin_variants = merge(joslin_hg38_out, joslin_input, by = "rsid")joslin_variants$Author = "Joslin"joslin_variants <-joslin_variants %>% arrange(chrom)#----------------------##Klein##Input = 1446##Output = 1425##non-annotated = 21#----------------------klein_variants = merge(klein_hg38_out, klein_input, by = "rsid")klein_variants$Author = "Klein"klein_variants <- klein_variants %>% arrange(chrom)#-----------------------##Myint##Input n = 1079#Output n = 1067## non-annotated n= 10#-----------------------myint_variants = merge(myint_hg38_out, myint_input, by = "rsid")myint_variants$Author = "Myint"myint_variants <- myint_variants %>% arrange(chrom)#---------------##Castaldi##Input = 296#Output = 296#-------------castaldi_variants = merge(castaldi_hg38, castaldi_input, by = "rsid")castaldi_variants$Author = "Castaldi"castaldi_variants <- castaldi_variants %>% arrange(chrom)#---------------##Selvarajan##Input = 21689#Output = 21385#do not match#---------------selvarajan_variants = merge(selvarajan_hg38, selvarajan_input, by = "rsid")selvarajan_variants$Author = "Selvarajan"selvarajan_variants <- selvarajan_variants %>% arrange(chrom)#---------------##Soemedi##Input = 231#Output = 229#do not match#---------------soemedi_variants = merge(soemedi_poshg38, soemedi_input, by = "rsid")soemedi_variants$Author = "Soemedi"soemedi_variants = soemedi_variants %>% arrange(chrom)#---------------##Zhang##Input = 379##Output = 373#---------------zhang_variants = merge(zhang_hg38, zhang_input, by = "rsid")zhang_variants$Author = "Zhang"zhang_variants = zhang_variants %>% arrange(chrom)names(zhang_hg38)[1:3] <- c("chrom", "pos", "rsid")names(zhang_input)[1:3] <- c("rsid", "ref", "alt")#----------------------Â´##STEP 3 merge files## n=28233## n_uniq= 27986## overlapping n= 284#---------------------merged = rbind(ajore_variants, castaldi_variants, joslin_variants,               klein_variants, myint_variants, soemedi_variants, selvarajan_variants,               zhang_variants)merged$tested_variants = paste(merged$chrom, ":",                                              merged$pos, "-",                                              merged$ref, "/",                                              merged$alt, sep = "")merged = merged %>%  distinct(tested_variants, .keep_all = TRUE)